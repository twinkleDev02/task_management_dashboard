<div class="">
  <div class="row justify-content-center">
    <div class="col-12">
      <div class="p-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="card-title mb-0 fs-3 fw-bold text-primary">Task Management </h2>
        </div>

        <div class="row g-3 mb-4 align-items-center">
          <div class="col-12 col-md-5">
            <div class="input-group">
              <span class="input-group-text"><i class="bi bi-search"></i></span>
              <input
                type="text"
                class="form-control"
                placeholder="Search tasks..."
                [(ngModel)]="searchText"
                (input)="applyFilters()"
              />
            </div>
          </div>

          <div class="col-6 col-md-3">
            <select class="form-select" [(ngModel)]="selectedStatus" (change)="applyFilters()">
              <option [ngValue]="null">All Statuses</option>
              <option *ngFor="let status of statusOptions" [value]="status">{{ status }}</option>
            </select>
          </div>

          <div class="col-6 col-md-3">
            <select class="form-select" [(ngModel)]="selectedPriority" (change)="applyFilters()">
              <option [ngValue]="null">All Priorities</option>
              <option *ngFor="let priority of priorityOptions" [value]="priority">
                {{ priority }}
              </option>
            </select>
          </div>
        </div>

        <p-table
          #dt
          [value]="filteredTasks"
          [paginator]="true"
          [rows]="10"
          [tableStyle]="{ 'min-width': '50rem' }"
          class="p-datatable-sm"
        >
          <ng-template pTemplate="header">
  <tr>
    <th pSortableColumn="title" class="fw-bold">
      Task <p-sortIcon field="title"></p-sortIcon>
    </th>
    <th class="fw-bold d-none d-md-table-cell">Description</th>
    <th pSortableColumn="priority" class="fw-bold text-center">
      Priority <p-sortIcon field="priority"></p-sortIcon>
    </th>
    <th pSortableColumn="status" class="fw-bold text-center">
      Status <p-sortIcon field="status"></p-sortIcon>
    </th>
    <th pSortableColumn="dueDate" class="fw-bold">
      Due Date <p-sortIcon field="dueDate"></p-sortIcon>
    </th>
    <th class="fw-bold text-center">Actions</th>
  </tr>
</ng-template>

          <ng-template pTemplate="body" let-task>
  <tr class="task-row">
    <td class="d-flex align-items-center">
      <div class="task-icon-container me-3">
        <i
          [class]="getTaskIcon(task.title)"
          class="p-2 rounded-circle fs-5"
          [ngClass]="{
            'bg-primary-light text-primary': true,
            'bg-info-light text-info': task.status === 'Pending',
            'bg-success-light text-success': task.status === 'Completed'
          }"
        ></i>
      </div>
      <div>
        <h6 class="mb-0 fw-bold">{{ task.title }}</h6>
      </div>
    </td>
    <td class="d-none d-md-table-cell text-muted">{{ task.description }}</td>
    <td class="text-center">
      <p-tag
        [value]="task.priority"
        [severity]="getPrioritySeverity(task.priority)"
      ></p-tag>
    </td>
    <td class="text-center">
      <p-badge
        [value]="task.status"
        [severity]="task.status === 'Completed' ? 'success' : 'warn'"
      ></p-badge>
    </td>
    <td class="text-muted">{{ task.dueDate | date }}</td>
    <td class="text-center">
      <button pButton type="button" icon="pi pi-pencil" class="p-button-rounded p-button-sm p-button-warning p-button-text me-2" (click)="onEdit(task)">Edit</button>
      <button pButton type="button" icon="pi pi-trash" class="p-button-rounded p-button-sm p-button-danger p-button-text" (click)="onDelete(task.id)">Delete</button>
    </td>
  </tr>
</ng-template>

          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5" class="text-center text-gray-500">No tasks found.</td>
            </tr>
          </ng-template>

          <ng-template pTemplate="paginatorleft">
            <p-button
              type="button"
              icon="pi pi-plus"
              label="Add Task"
              class="p-button-rounded p-button-success"
              [routerLink]="'/tasks/add'"
            ></p-button>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
</div>
